# üéÆ –†–ï–ó–Æ–ú–ï –¢–ó: AI D&D Master Service

## üìã –ö–†–ê–¢–ö–û–ï –û–ü–ò–°–ê–ù–ò–ï
MVP –≤–µ–±-—Å–µ—Ä–≤–∏—Å–∞ –¥–ª—è D&D —Å –ò–ò-–º–∞—Å—Ç–µ—Ä–æ–º, –ø—Ä–µ–¥–Ω–∞–∑–Ω–∞—á–µ–Ω–Ω—ã–π –¥–ª—è –∏–≥—Ä—ã —Å –¥—Ä—É–∑—å—è–º–∏. –í–∫–ª—é—á–∞–µ—Ç –≥–æ–ª–æ—Å–æ–≤—É—é —Å–≤—è–∑—å, –ø–µ—Ä—Å–∏—Å—Ç–µ–Ω—Ç–Ω—É—é –ø–∞–º—è—Ç—å –∫–∞–º–ø–∞–Ω–∏–∏ –∏ –ø–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—ã—Ö –ò–ò-–∞—Å—Å–∏—Å—Ç–µ–Ω—Ç–æ–≤.

## üéØ –ö–õ–Æ–ß–ï–í–´–ï –¶–ï–õ–ò
1. **–û—Å–Ω–æ–≤–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è**: –ò–ò –≤–µ–¥–µ—Ç D&D —Å–µ—Å—Å–∏–∏ –¥–ª—è 4-5 –∏–≥—Ä–æ–∫–æ–≤
2. **–¢–µ—Ö–Ω–∏—á–µ—Å–∫–∞—è —Ü–µ–ª—å**: –°—Ç–∞–±–∏–ª—å–Ω–∞—è —Ä–∞–±–æ—Ç–∞ –≤ —Ç–µ—á–µ–Ω–∏–µ 2-—á–∞—Å–æ–≤—ã—Ö —Å–µ—Å—Å–∏–π
3. **–ë–∏–∑–Ω–µ—Å-—Ü–µ–ª—å**: –ë–µ—Å–ø–ª–∞—Ç–Ω—ã–π –¥–ª—è –¥—Ä—É–∑–µ–π, –∫–æ–Ω—Ç—Ä–æ–ª—å —Ä–∞—Å—Ö–æ–¥–æ–≤ API
4. **UX —Ü–µ–ª—å**: –ü—Ä–æ—Å—Ç–æ—Ç–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –±–µ–∑ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏

## üèóÔ∏è –ê–†–•–ò–¢–ï–ö–¢–£–†–ù–´–ï –†–ï–®–ï–ù–ò–Ø

### –í—ã–±–æ—Ä —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–π
- **Frontend**: Next.js + TypeScript (–±—ã—Å—Ç—Ä–∞—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∞, SSR)
- **Backend**: Node.js + Fastify (–ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å, –ø—Ä–æ—Å—Ç–æ—Ç–∞)
- **Database**: SQLite (–Ω–µ—Ç —Å–ª–æ–∂–Ω–æ—Å—Ç–∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏, –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –¥–ª—è MVP)
- **LLM**: Claude 3.5 Sonnet –¥–ª—è DM, GPT-4o-mini –¥–ª—è –∞—Å—Å–∏—Å—Ç–µ–Ω—Ç–æ–≤ (–∫–∞—á–µ—Å—Ç–≤–æ vs —Å—Ç–æ–∏–º–æ—Å—Ç—å)
- **Voice**: WebRTC mesh (–ø—Ä–æ—Å—Ç–æ—Ç–∞ vs SFU)

### –°–∏—Å—Ç–µ–º–Ω—ã–µ –ø–∞—Ç—Ç–µ—Ä–Ω—ã
```
–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ -> WebRTC Mesh (–≥–æ–ª–æ—Å)
     ‚Üì
   Frontend (React)
     ‚Üì  
   WebSocket (—á–∞—Ç)
     ‚Üì
   Backend API
     ‚Üì
   Context Manager -> LLM APIs
     ‚Üì
   SQLite (–ø–∞–º—è—Ç—å)
```

## üß† –°–ò–°–¢–ï–ú–ê –ü–ê–ú–Ø–¢–ò

### –°—Ç—Ä–∞—Ç–µ–≥–∏—è —Å–∂–∞—Ç–∏—è –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞
1. **–ê–∫—Ç–∏–≤–Ω–∞—è —Å—Ü–µ–Ω–∞**: –¢–æ–ª—å–∫–æ –ø–æ—Å–ª–µ–¥–Ω–∏–µ 10-20 —Ö–æ–¥–æ–≤
2. **–°—É—â–Ω–æ—Å—Ç–∏**: –ö–∞—Ä—Ç–æ—á–∫–∏ –ø–µ—Ä—Å–æ–Ω–∞–∂–µ–π/–ª–æ–∫–∞—Ü–∏–π/–∫–≤–µ—Å—Ç–æ–≤ 
3. **–§–∞–∫—Ç—ã**: –°—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ key-value –ø–∞—Ä—ã
4. **–°–≤–æ–¥–∫–∏**: –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Å–∂–∞—Ç–∏–µ —á–µ—Ä–µ–∑ GPT-4o-mini

### –ü–∞—Ç—Ç–µ—Ä–Ω —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∫–æ–Ω—Ç–µ–∫—Å—Ç–æ–º
```javascript
// –ü—Å–µ–≤–¥–æ–∫–æ–¥ –∞–ª–≥–æ—Ä–∏—Ç–º–∞
function buildPrompt(roomId) {
  const context = {
    system: dmSystemPrompt,
    activeScene: getLastMessages(roomId, 20),
    entities: getActiveEntities(roomId),
    facts: getRelevantFacts(roomId),
    summary: getSessionSummary(roomId)
  };
  
  return optimizeTokens(context, MAX_TOKENS);
}
```

## üíª –¢–ï–•–ù–ò–ß–ï–°–ö–ê–Ø –†–ï–ê–õ–ò–ó–ê–¶–ò–Ø

### API —ç–Ω–¥–ø–æ–∏–Ω—Ç—ã
```
POST /rooms              # –°–æ–∑–¥–∞—Ç—å –∫–æ–º–Ω–∞—Ç—É
GET  /rooms/:id          # –ü–æ–ª—É—á–∏—Ç—å –¥–∞–Ω–Ω—ã–µ –∫–æ–º–Ω–∞—Ç—ã
POST /dm/reply           # –û—Ç–≤–µ—Ç –ò–ò-–º–∞—Å—Ç–µ—Ä–∞
POST /assistant/reply    # –û—Ç–≤–µ—Ç –∞—Å—Å–∏—Å—Ç–µ–Ω—Ç–∞
GET  /entities/:id       # –ü–æ–ª—É—á–∏—Ç—å —Å—É—â–Ω–æ—Å—Ç—å
POST /summary            # –°–æ–∑–¥–∞—Ç—å —Å–≤–æ–¥–∫—É
```

### –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö (–æ—Å–Ω–æ–≤–Ω—ã–µ —Ç–∞–±–ª–∏—Ü—ã)
```sql
rooms: id, title, settings, created_at
sessions: id, room_id, started_at, summary
messages: id, room_id, role, content, timestamp
entities: id, room_id, type, name, data
facts: id, entity_id, key, value, confidence
```

## üéÆ –ò–ì–†–û–í–ê–Ø –ú–ï–•–ê–ù–ò–ö–ê

### –ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã –ò–ò-–º–∞—Å—Ç–µ—Ä–∞
- `roll_dice(formula)` - —á–µ—Å—Ç–Ω—ã–µ –±—Ä–æ—Å–∫–∏
- `get_entity(id)` - –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –ø–µ—Ä—Å–æ–Ω–∞–∂–∞—Ö/–º–∏—Ä–µ
- `update_fact(entity, key, value)` - –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Ñ–∞–∫—Ç–æ–≤
- `create_npc(name, description)` - —Å–æ–∑–¥–∞–Ω–∏–µ NPC

### –ö–æ–º–∞–Ω–¥—ã –∏–≥—Ä–æ–∫–æ–≤
- `/roll 1d20+3` - –±—Ä–æ—Å–æ–∫ –∫—É–±–æ–≤
- `/note —Ç–µ–∫—Å—Ç` - –ª–∏—á–Ω–∞—è –∑–∞–º–µ—Ç–∫–∞
- `/gmk —Ç–µ–∫—Å—Ç` - –ø—Ä–∏–≤–∞—Ç–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ –º–∞—Å—Ç–µ—Ä—É

## üìä –≠–ö–û–ù–û–ú–ò–ö–ê –ü–†–û–ï–ö–¢–ê

### –†–∞—Å—Ö–æ–¥—ã –Ω–∞ API (–º–µ—Å—è—Ü)
- **DM (GPT-4o)**: ~$30 –ø—Ä–∏ 8 —Å–µ—Å—Å–∏—è—Ö/–º–µ—Å
- **–ê—Å—Å–∏—Å—Ç–µ–Ω—Ç—ã (GPT-4o-mini)**: ~$8
- **–°—É–º–º–∞—Ä–∏–∑–∞—Ü–∏—è**: ~$5
- **–ë—É—Ñ–µ—Ä**: ~$15
- **–ò–¢–û–ì–û: ~$48/–º–µ—Å

### –ò–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–∞
- **VPS**: ‚Ç¨12/–º–µ—Å
- **–î–æ–º–µ–Ω**: ‚Ç¨1/–º–µ—Å
- **–ò–¢–û–ì–û**: ‚Ç¨13/–º–µ—Å

### –û–±—â–∏–π –±—é–¥–∂–µ—Ç: ~‚Ç¨65/–º–µ—Å

## ‚ö†Ô∏è –†–ò–°–ö–ò –ò –ú–ò–¢–ò–ì–ê–¶–ò–Ø

### –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ —Ä–∏—Å–∫–∏
1. **WebRTC –Ω–µ—Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å** ‚Üí Fallback –Ω–∞ –≥–æ—Ç–æ–≤—ã–µ —Ä–µ—à–µ–Ω–∏—è (Jitsi)
2. **–í—ã—Å–æ–∫–∏–µ —Ä–∞—Å—Ö–æ–¥—ã API** ‚Üí –ê–≥—Ä–µ—Å—Å–∏–≤–Ω–∞—è –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞
3. **–õ–∞—Ç–µ–Ω—Ç–Ω–æ—Å—Ç—å –ò–ò** ‚Üí –°—Ç—Ä–∏–º–∏–Ω–≥ + –∫–æ—Ä–æ—Ç–∫–∏–µ –ø—Ä–æ–º–ø—Ç—ã –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é
4. **–ü–µ—Ä–µ–ø–æ–ª–Ω–µ–Ω–∏–µ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞** ‚Üí –ò–µ—Ä–∞—Ä—Ö–∏—á–µ—Å–∫–∏–µ —Å–≤–æ–¥–∫–∏

### –ü—Ä–æ–¥—É–∫—Ç–æ–≤—ã–µ —Ä–∏—Å–∫–∏
1. **–ö–∞—á–µ—Å—Ç–≤–æ –ò–ò-–º–∞—Å—Ç–µ—Ä–∞** ‚Üí –ò—Ç–µ—Ä–∞—Ç–∏–≤–Ω—ã–π –ø—Ä–æ–º–ø—Ç-–∏–Ω–∂–∏–Ω–∏—Ä–∏–Ω–≥
2. **–°–ª–æ–∂–Ω–æ—Å—Ç—å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è** ‚Üí –§–æ–∫—É—Å –Ω–∞ –ø—Ä–æ—Å—Ç–æ—Ç—É UX
3. **–ú–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ** ‚Üí –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ –Ω–∞ 10 –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω—ã—Ö –∫–æ–º–Ω–∞—Ç

## üöÄ –ö–†–ò–¢–ï–†–ò–ò –ì–û–¢–û–í–ù–û–°–¢–ò

### –ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è MVP
- [ ] 4 –∏–≥—Ä–æ–∫–∞ –ø—Ä–æ–≤–æ–¥—è—Ç 2-—á–∞—Å–æ–≤—É—é —Å–µ—Å—Å–∏—é –±–µ–∑ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö –±–∞–≥–æ–≤
- [ ] –ò–ò-–º–∞—Å—Ç–µ—Ä –ø–æ–º–Ω–∏—Ç –∫–æ–Ω—Ç–µ–∫—Å—Ç –≤ —Ç–µ—á–µ–Ω–∏–µ —Å–µ—Å—Å–∏–∏
- [ ] –ì–æ–ª–æ—Å–æ–≤–∞—è —Å–≤—è–∑—å —Ä–∞–±–æ—Ç–∞–µ—Ç —Å—Ç–∞–±–∏–ª—å–Ω–æ
- [ ] –°—Ç–æ–∏–º–æ—Å—Ç—å —Å–µ—Å—Å–∏–∏ < $6

### –ü–æ–∫–∞–∑–∞—Ç–µ–ª–∏ –∫–∞—á–µ—Å—Ç–≤–∞
- [ ] –í—Ä–µ–º—è –æ—Ç–∫–ª–∏–∫–∞ –ò–ò < 5 —Å–µ–∫—É–Ω–¥ (95% –∑–∞–ø—Ä–æ—Å–æ–≤)
- [ ] –ì–æ–ª–æ—Å–æ–≤–∞—è –∑–∞–¥–µ—Ä–∂–∫–∞ < 200ms
- [ ] Uptime > 99% –≤ —Ç–µ—á–µ–Ω–∏–µ —Å–µ—Å—Å–∏–∏
- [ ] –ú–æ–±–∏–ª—å–Ω–∞—è –≤–µ—Ä—Å–∏—è —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–∞

## üìã –ü–õ–ê–ù –î–ï–ô–°–¢–í–ò–ô

### Immediate Next Steps
1. **–ù–∞—Å—Ç—Ä–æ–∏—Ç—å –æ–∫—Ä—É–∂–µ–Ω–∏–µ** (—Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π, API –∫–ª—é—á–∏, VPS)
2. **–î–µ–Ω—å 1-2**: –ë–∞–∑–æ–≤–∞—è –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–∞ + —á–∞—Ç
3. **–î–µ–Ω—å 3-4**: –ò–ò-–∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è + –ø—Ä–æ–º–ø—Ç—ã
4. **–î–µ–Ω—å 5-6**: –°–∏—Å—Ç–µ–º–∞ –ø–∞–º—è—Ç–∏
5. **–î–µ–Ω—å 7-9**: WebRTC –≥–æ–ª–æ—Å
6. **–î–µ–Ω—å 10-12**: –ü–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—ã–µ –∞—Å—Å–∏—Å—Ç–µ–Ω—Ç—ã
7. **–î–µ–Ω—å 13-15**: –ü–æ–ª–∏—Ä–æ–≤–∫–∞ –∏ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

### –ö–æ–Ω—Ç—Ä–æ–ª—å–Ω—ã–µ —Ç–æ—á–∫–∏
- **–ù–µ–¥–µ–ª—è 1**: –§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–π –ò–ò-–º–∞—Å—Ç–µ—Ä —Å –ø–∞–º—è—Ç—å—é
- **–ù–µ–¥–µ–ª—è 2**: –ü–æ–ª–Ω—ã–π MVP —Å –≥–æ–ª–æ—Å–æ–º –∏ –∞—Å—Å–∏—Å—Ç–µ–Ω—Ç–∞–º–∏
- **–î–µ–Ω—å 15**: Production-ready –≤–µ—Ä—Å–∏—è

## üéØ SUCCESS METRICS

### Technical KPIs
- API Response Time: <3s average
- Voice Quality: <200ms latency, <5% packet loss
- System Uptime: >99% during sessions
- Cost per Session: <$6

### Product KPIs  
- Session Duration: 2+ hours without critical issues
- User Retention: Friends return for second session
- AI Quality: Coherent storytelling throughout session

–≠—Ç–æ—Ç –ø–ª–∞–Ω –¥–∞–µ—Ç —á–µ—Ç–∫–æ–µ —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–æ–µ –∑–∞–¥–∞–Ω–∏–µ –∏ roadmap –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è MVP AI D&D Master Service –∑–∞ 15 –¥–Ω–µ–π.

## üß† –ü–†–ï–ò–ú–£–©–ï–°–¢–í–ê CLAUDE 3.5 SONNET –î–õ–Ø D&D –ú–ê–°–¢–ï–†–ê

### –ö–∞—á–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏
- **–î–ª–∏–Ω–Ω—ã–π –∫–æ–Ω—Ç–µ–∫—Å—Ç**: 200k —Ç–æ–∫–µ–Ω–æ–≤ vs 128k —É GPT-4o
- **–†—É—Å—Å–∫–æ—è–∑—ã—á–Ω–æ–µ –ø–æ–≤–µ—Å—Ç–≤–æ–≤–∞–Ω–∏–µ**: –ü—Ä–µ–≤–æ—Å—Ö–æ–¥–Ω–æ–µ –∫–∞—á–µ—Å—Ç–≤–æ –ª–∏—Ç–µ—Ä–∞—Ç—É—Ä–Ω–æ–≥–æ —è–∑—ã–∫–∞
- **–ü–æ–Ω–∏–º–∞–Ω–∏–µ —Ä–æ–ª–µ–≤—ã—Ö –∏–≥—Ä**: –û—Ç–ª–∏—á–Ω–æ –∑–Ω–∞–∫–æ–º —Å –º–µ—Ö–∞–Ω–∏–∫–∞–º–∏ D&D –∏ storytelling
- **–ö—Ä–µ–∞—Ç–∏–≤–Ω–æ—Å—Ç—å**: –í—ã—Å–æ–∫–æ–µ –∫–∞—á–µ—Å—Ç–≤–æ –∏–º–ø—Ä–æ–≤–∏–∑–∞—Ü–∏–∏ –∏ —Å–æ–∑–¥–∞–Ω–∏—è —Å—é–∂–µ—Ç–Ω—ã—Ö –ø–æ–≤–æ—Ä–æ—Ç–æ–≤

### –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –ø—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞
- **–°—Ç–æ–∏–º–æ—Å—Ç—å**: $15 vs $30 –∑–∞ 1M —Ç–æ–∫–µ–Ω–æ–≤ (–¥–µ—à–µ–≤–ª–µ GPT-4o)
- **Tool calling**: –ü–æ–¥–¥–µ—Ä–∂–∫–∞ —Ñ—É–Ω–∫—Ü–∏–π –¥–ª—è –∏–≥—Ä–æ–≤—ã—Ö –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤
- **Streaming**: –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –ø–æ—Ç–æ–∫–æ–≤–æ–≥–æ –≤—ã–≤–æ–¥–∞ –¥–ª—è real-time –æ—Ç–≤–µ—Ç–æ–≤
- **Context window**: –ë–æ–ª—å—à–µ –º–µ—Å—Ç–∞ –¥–ª—è –∏—Å—Ç–æ—Ä–∏–∏ –∫–∞–º–ø–∞–Ω–∏–∏

### –≠–∫–æ–Ω–æ–º–∏—è –±—é–¥–∂–µ—Ç–∞
```
–°—Ä–∞–≤–Ω–µ–Ω–∏–µ –º–µ—Å—è—á–Ω—ã—Ö —Ä–∞—Å—Ö–æ–¥–æ–≤ (8 —Å–µ—Å—Å–∏–π):
- GPT-4o: ~$30/–º–µ—Å
- Claude 3.5 Sonnet: ~$25/–º–µ—Å
- –≠–∫–æ–Ω–æ–º–∏—è: ~$5/–º–µ—Å –∏–ª–∏ $60/–≥–æ–¥
```
